# chocula update

```
$ make fetch-sources
```

* loads from [chocula-sources-snapshot-2022-07-06](https://archive.org/details/chocula-sources-snapshot-2022-07-06)
* succeeds, data dir looks like:

```shell
$ du -hs data/
1.7G    data/
tir@reka:~/code/git.archive.org/webgroup/chocula [git:master] $ ll data/
total 1.7G
drwxrwxr-x  2 tir tir 4.0K May 14 22:38 ./
drwxrwxr-x 10 tir tir 4.0K Sep 14  2023 ../
-rw-rw-r--  1 tir tir 2.5M Jul  7  2022 awol-index-top-issn.json
-rw-rw-r--  1 tir tir 226K Jul  7  2022 cariniana.csv
-rw-rw-r--  1 tir tir  78M Jul  7  2022 container_export.json
-rw-rw-r--  1 tir tir  40M Jul  7  2022 container_stats.json
-rw-rw-r--  1 tir tir  35M Jul  7  2022 crossref_titles.csv
-rw-rw-r--  1 tir tir  21M Jul  7  2022 doaj.csv
-rw-rw-r--  1 tir tir 3.7M Jul  7  2022 entrez-journals.csv
-rw-rw-r--  1 tir tir 8.9M Jul  7  2022 entrez.txt
-rw-rw-r--  1 tir tir 2.8M Jul  7  2022 era_2018_journal_list.csv
-rw-rw-r--  1 tir tir 9.6M Jul  7  2022 ezb_metadata.json
-rw-rw-r--  1 tir tir 5.1M Jul  7  2022 gold_oa.csv
-rw-rw-r--  1 tir tir 680M Jul  7  2022 hathi_serials.tsv
-rw-rw-r--  1 tir tir  63M Jul  7  2022 homepage_status.json
-rw-rw-r--  1 tir tir 471M Jul  7  2022 issn_meta.filtered.json
-rw-rw-r--  1 tir tir  45M Jul  7  2022 ISSN-to-ISSN-L.txt
-rw-rw-r--  1 tir tir  12K Sep 14  2023 kbart_CLOCKSS-triggered.txt
-rw-rw-r--  1 tir tir 9.4M Jul  7  2022 kbart_CLOCKSS.txt
-rw-rw-r--  1 tir tir 2.0M Jul  7  2022 kbart_JSTOR.txt
-rw-rw-r--  1 tir tir 2.2M Jul  7  2022 kbart_LOCKSS.txt
-rw-rw-r--  1 tir tir  28M Jul  7  2022 kbart_Portico.txt
-rw-rw-r--  1 tir tir 6.0M Jul  7  2022 mag-journals.txt
-rw-rw-r--  1 tir tir 486K Jul  7  2022 manual_longtail_homepages.tsv
-rw-rw-r--  1 tir tir  12M Jul  7  2022 norwegian_register.csv
-rw-rw-r--  1 tir tir  13M Jul  7  2022 onix_pkp_pln.csv
-rw-rw-r--  1 tir tir 134M Jul  7  2022 onix_scholarsportal.csv
-rw-rw-r--  1 tir tir 8.1M Jul  7  2022 openalex-journals.txt
-rw-rw-r--  1 tir tir  20M Jul  7  2022 openapc.csv
-rw-rw-r--  1 tir tir 3.6M Jul  7  2022 road.tsv
-rw-rw-r--  1 tir tir 3.3M Jul  7  2022 romeo-journals.csv
-rw-rw-r--  1 tir tir 408K Jul  7  2022 romeo-policies.csv
-rw-rw-r--  1 tir tir 6.6M Jul  7  2022 scielo.json
-rw-rw-r--  1 tir tir 2.2M Jul  7  2022 sim_master_title_metadata.csv
-rw-rw-r--  1 tir tir  11M Jul  7  2022 szczepanski.json
-rw-rw-r--  1 tir tir 107K Jul  7  2022 vanished_journals_disapeared.csv
-rw-rw-r--  1 tir tir  81K Jul  7  2022 vanished_journals_inactive.csv
-rw-rw-r--  1 tir tir  13M Jul  7  2022 wikidata_journals.tsv
-rw-rw-r--  1 tir tir 1.2M Jul  7  2022 zdb_fize_homepage_available.json
```

Trying to update sources.

```
$ make update-source
```

About 10 of these files can be updated:

```
$ tree -sh data/2024-05-14/
[4.0K]  data/2024-05-14/
├── [ 41M]  crossref_titles.csv
├── [ 24M]  doaj.csv
├── [9.2M]  entrez.txt
├── [ 54M]  ISSN-to-ISSN-L.txt
├── [ 12K]  kbart_CLOCKSS-triggered.txt
├── [ 11M]  kbart_CLOCKSS.txt
├── [1.9M]  kbart_JSTOR.txt
├── [2.3M]  kbart_LOCKSS.txt
├── [ 31M]  kbart_Portico.txt
└── [ 23M]  onix_pkp_pln.csv

0 directories, 10 files
```

Copied updatable sources to `data/` dir, then upload to archive item.

```
$ cp data/2024-05-14/* data/
$ make upload-sources
```

Then, try to recreate the database:

```
$ make database
```

